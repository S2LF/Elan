<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />
    <link rel="stylesheet" href="style.css">
    <title>Morpion</title>
</head>
<body>
    
    <div id="affich"></div>
    <div id="border">
        <div class="case"> </div>
        <div class="case"> </div>
        <div class="case"> </div>
        <div class="case"> </div>
        <div class="case"> </div>
        <div class="case"> </div>
        <div class="case"> </div>
        <div class="case"> </div>
        <div class="case"> </div>
    </div>




    <script
    src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
    crossorigin="anonymous"></script>

<script>

    let tour = 'X'

    console.log($(".case").indexOf)

    $('#affich').text("C'est à "+tour+" de jouer")

    function handleClick(laCase){
        
        laCase.text(tour)
        if(verifEncore()){
            if($(".case").indexOf(" ") == -1){
            matchNul()
            }
            victoire()
        }else{
            if (tour == 'X') {
                tour = 'O'
            } else {
                tour = 'X'
            }
            $('#affich').text("C'est à "+tour+" de jouer")

            laCase.off('click')
        }
    
    }

    $(".case").on("click", function(){
        handleClick($(this))
        
    })
    
    function victoire(){
        $('#affich').text("C'est gagné pour "+tour)
       
        $('.case').off('click')

        resetMorpion()
    }


    function resetMorpion(){
        $(".case").each(function(){
            $(this).text(" ")
        })
        $(".case").on("click", function(){
            handleClick($(this))
            
        })
    }

    function matchNul(){
            $('#affich').text("Match nul")
            $('#affich').on('click', function(){
                resetMorpion()})

            $('.case').off('click')
    }

   
function verifEncore(){
        let contenu = ""
 
        $(".case").each(function(){
            contenu += $(this).text() 
        })

        let patterns = [ [0,1,2], [3,4,5], [6,7,8],
                        [0,3,6], [1,4,7], [2,5,8],
                        [0,4,8], [2,4,6] ]


        let verif = false
        patterns.forEach(function(pat){
            let trio = contenu.charAt(pat[0])+contenu.charAt(pat[1])+contenu.charAt(pat[2])
            console.log(trio)
            if(trio == tour.repeat(3)){
                verif = true
            }
            
        })
        
        return verif
}



 



    function verif(){

    // Ligne 1
    //  for(i=0; i<3; i++){
        if($(".case")[0].innerText != "" 
            && $(".case")[0].innerText == $(".case")[1].innerText 
            && $(".case")[0].innerText == $(".case")[2].innerText) 
        {
            return true
        }
    // }  

    // Ligne 2
        if($(".case")[3].innerText != "" 
            && $(".case")[3].innerText == $(".case")[4].innerText 
            && $(".case")[3].innerText == $(".case")[5].innerText) 
        {
            return true
        }

    // Ligne 3
        if($(".case")[6].innerText != "" 
            && $(".case")[6].innerText == $(".case")[7].innerText 
            && $(".case")[6].innerText == $(".case")[8].innerText) 
        {
            return true
        }





    // Col 1

        if($(".case")[0].innerText != "" 
            && $(".case")[0].innerText == $(".case")[3].innerText 
            && $(".case")[0].innerText == $(".case")[6].innerText)
        {
            return true
        }
    
    // Col 2

        if($(".case")[1].innerText != "" 
            && $(".case")[1].innerText == $(".case")[4].innerText 
            && $(".case")[1].innerText == $(".case")[7].innerText)
        {
            return true
        }

    // Col 3

        if($(".case")[2].innerText != "" 
            && $(".case")[2].innerText == $(".case")[5].innerText 
            && $(".case")[2].innerText == $(".case")[8].innerText)
        {
            return true
        }



        
    // Diag 1

        if($(".case")[0].innerText != "" 
            && $(".case")[0].innerText == $(".case")[4].innerText 
            && $(".case")[0].innerText == $(".case")[8].innerText)
        {
            return true
        }

    // Diag 2

        if($(".case")[2].innerText != "" 
            && $(".case")[2].innerText == $(".case")[4].innerText 
            && $(".case")[2].innerText == $(".case")[6].innerText)
        {
            return true
        }
    


    }









</script>


</body>
</html>